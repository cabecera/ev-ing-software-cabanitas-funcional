<%- include('../partials/header', { title: 'Mi Dashboard' }) %>
<%- include('../partials/navbar') %>

<div class="dashboard">
        <h1>Mi Dashboard</h1>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>Total Reservas</h3>
                <p class="stat-number"><%= stats.totalReservas %></p>
            </div>

            <div class="stat-card">
                <h3>Reservas Activas</h3>
                <p class="stat-number"><%= stats.reservasActivas %></p>
            </div>

            <div class="stat-card">
                <h3>Préstamos Activos</h3>
                <p class="stat-number"><%= stats.prestamosActivos %></p>
            </div>
        </div>

        <% if (reservasActivas && reservasActivas.length > 0) { %>
        <div class="section">
            <h2>Próximas Reservas</h2>
            <div class="alert alert-info" style="margin: 1rem 0; padding: 1rem; background-color: #e3f2fd; border-left: 4px solid #2196f3; border-radius: 4px;">
                <strong>Recordatorio de Notificaciones:</strong>
                <p style="margin: 0.5rem 0 0 0;">Se te notificará en <strong>1 semana</strong> y también <strong>72 horas antes</strong> de tu reserva para que puedas prepararte con anticipación.</p>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Cabaña</th>
                            <th>Fecha Inicio</th>
                            <th>Fecha Fin</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% reservasActivas.forEach(reserva => { %>
                        <tr>
                            <td><%= reserva.cabana.nombre %></td>
                            <td><%= new Date(reserva.fechaInicio).toLocaleDateString() %></td>
                            <td><%= new Date(reserva.fechaFin).toLocaleDateString() %></td>
                            <td><span class="badge badge-<%= reserva.estado %>"><%= reserva.estado %></span></td>
                        </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        </div>
        <% } %>

        <div class="actions-section" style="margin: 2rem 0;">
            <a href="/calendario/disponibilidad" class="btn btn-primary">Ver Calendario</a>
            <a href="/reservas/solicitar" class="btn btn-success">Nueva Reserva</a>
        </div>

        <% if (notificaciones && notificaciones.length > 0) { %>
        <div class="notifications-section">
            <h2>Notificaciones Recientes</h2>
            <ul class="notification-list">
                <% notificaciones.forEach(notif => { %>
                <li class="notification-item">
                    <strong><%= notif.titulo %></strong>
                    <p><%= notif.mensaje %></p>
                </li>
                <% }); %>
            </ul>
        </div>
        <% } %>
</div>
<%- include('../partials/footer') %>
