<%- include('../partials/header', { title: 'Préstamos' }) %>
<%- include('../partials/navbar') %>

<h1>Préstamos de Implementos</h1>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Cliente</th>
                <th>Implemento</th>
                <th>Cantidad</th>
                <th>Fecha Préstamo</th>
                <th>Estado</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <% prestamos.forEach(prestamo => { %>
            <tr>
                <td><%= prestamo.cliente.nombre %> <%= prestamo.cliente.apellido %></td>
                <td><%= prestamo.implemento.nombre %></td>
                <td><%= prestamo.cantidad %></td>
                <td><%= new Date(prestamo.fechaPrestamo).toLocaleDateString() %></td>
                <td><span class="badge badge-<%= prestamo.estado %>"><%= prestamo.estado %></span></td>
                <td>
                    <% if (prestamo.estado === 'activo') { %>
                        <form method="POST" action="/prestamos/<%= prestamo.id %>/devolver" style="display: inline;">
                            <button type="submit" class="btn btn-success btn-sm">Devolver</button>
                        </form>
                    <% } %>
                </td>
            </tr>
            <% }); %>
        </tbody>
    </table>
</div>

<%- include('../partials/footer') %>

